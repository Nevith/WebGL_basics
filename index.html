<!DOCTYPE html>

<html>
    <head>
        <title>WebGL basics</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <!-- Jquery, Bootstrap and FontAwesome -->
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css"
              integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS"
              crossorigin="anonymous">
        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
                integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
                crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"
                integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut"
                crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js"
                integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k"
                crossorigin="anonymous"></script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

        <!-- WebGL libs -->
        <script src="js/libs/gl-matrix/gl-matrix.js"></script>
        <!-- Parse .obj files -->


        <!-- FONT -->
        <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Ubuntu" />

        <!-- Our code -->
        <script src="js/glDrawable.js"></script>
        <script src="js/uiController.js"></script>
        <script src="js/glController.js"></script>
        <link rel="stylesheet" href="css/style.css">

        <!-- Shaders -->
        <script id="vertex-shader" type="x-shader/x-vertex">

            #version 100
            
            precision mediump float;

            uniform mat4 PVM;
            uniform mat4 PVM_INVERSE_TRANSPOSE;
            uniform vec3 LIGHT;
            uniform mat4 M;

            attribute vec3 vertex;
            attribute vec3 normal;
            attribute vec2 uv;

            varying vec2 texture_coordinates;
            varying vec3 normal_v;
            varying vec3 surface_to_light;

            void main(){
                gl_Position= PVM * vec4(vertex,1);
                texture_coordinates = uv;
                normal_v = mat3(PVM_INVERSE_TRANSPOSE) * normal;

                // compute the world position of the surfoace
                vec3 surface_world_position = (M * vec4(vertex,1)).xyz;

                // compute the vector of the surface to the light
                // and pass it to the fragment shader
                surface_to_light = LIGHT - surface_world_position;
            }

        </script>
        <script id="fragment-shader" type="x-shader/x-fragment">
            #version 100

            precision mediump float;

            uniform sampler2D sampler;

            varying vec2 texture_coordinates;
            varying vec3 normal_v;
            varying vec3 surface_to_light;

            void main(){
                gl_FragColor = texture2D(sampler, texture_coordinates);

                float light = dot(normal_v, surface_to_light);

                gl_FragColor.rgb *= light;
            }
        </script>
    </head>

    <body>
        <div id="app" class="container">
            <div class="row">
                <canvas id="gl_canvas" class="col">
                    Your web browser does not support Canvas.
                </canvas>
            </div>
            <div id="base_instructions" class="row">
                <div id="camera_instructions" class="col">
                    <h3>Camera</h3>
                    <p>
                        <b>Move:</b> W A S D + Q and E<br>
                        <b>Rotate:</b> I J K L + U and O<br>
                        <b>Perspective change:</b> Space<br>
                    </p>
                </div>
                <div id="button_box">
                    <button class="btn btn-primary" style="margin: 5px"
                            onclick="selectObj()">
                        <span class="fa fa-plus"></span>
                        <button class="btn btn-warning" style="margin: 5px"
                                onclick="">
                            <span class="fa fa-plus"></span>
                    </button>
                </div>
            </div>
        </div>
        <div id="object_container" class="container">
        </div>
    </body>
</html>
